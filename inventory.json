{
  "audit_date": "2024-12-19",
  "audit_version": "1.0",
  "repository": "CDLHelp-website",
  "tags_inventory": {
    "google_analytics": {
      "measurement_id": "G-9SDEZPTE49",
      "implementation": "gtag.js",
      "location": "/pages/_document.js:51-57",
      "consent_mode": "v2_partial",
      "status": "active",
      "issues": ["Missing Enhanced Ecommerce events", "Incomplete custom dimensions"]
    },
    "google_tag_manager": {
      "container_id": "GTM-56GHWJC4",
      "implementation": "dynamic",
      "location": "/lib/tag-manager.js:15-45",
      "consent_integration": true,
      "status": "active",
      "issues": ["Only checks analytics consent, missing ad consent validation"]
    },
    "google_ads": {
      "ads_id": "AW-11366664092",
      "conversion_id": "UXMnCJi4quYaEJyPhqwq",
      "enhanced_conversions": true,
      "location": "/lib/google-enhanced-conversions.js",
      "status": "active",
      "issues": ["Hashing reliability", "Missing server-side implementation"]
    },
    "facebook_pixel": {
      "pixel_id": "NEXT_PUBLIC_FACEBOOK_PIXEL_ID",
      "advanced_matching": true,
      "location": "/lib/meta-standard-events.js",
      "capi_integration": true,
      "status": "active",
      "issues": ["Should use server-side hashing", "Hardcoded domain verification"]
    },
    "yandex_metrica": {
      "counter_id": "95028720",
      "location": "/lib/analytics.js:280-310",
      "status": "active",
      "issues": ["Missing consent integration"]
    },
    "amplitude": {
      "api_key": "environment_variable",
      "location": "/lib/analytics.js:150-200",
      "status": "active",
      "issues": ["No specific issues identified"]
    }
  },
  "consent_management": {
    "provider": "custom",
    "location": "/lib/consent-manager.js",
    "consent_mode_v2": "partial",
    "granular_consent": true,
    "status": "active",
    "missing_parameters": ["ad_user_data", "ad_personalization"]
  },
  "data_layer": {
    "initialization": "/pages/_document.js:80-82",
    "enhanced_ecommerce": false,
    "structured_events": false,
    "status": "needs_improvement",
    "critical_missing": [
      "purchase events",
      "subscription events", 
      "lead generation events",
      "quiz completion tracking"
    ]
  },
  "performance": {
    "dns_prefetch": true,
    "lazy_loading": true,
    "consent_based_loading": true,
    "bundle_size_estimate": "45KB",
    "render_blocking": false,
    "status": "good"
  },
  "environment_variables": {
    "configured": [
      "NEXT_PUBLIC_FACEBOOK_PIXEL_ID",
      "NEXT_PUBLIC_GOOGLE_ADS_CONVERSION_ID",
      "NEXT_PUBLIC_GA_MEASUREMENT_ID"
    ],
    "missing": [
      "FACEBOOK_ACCESS_TOKEN",
      "FACEBOOK_TEST_EVENT_CODE"
    ],
    "status": "partial"
  },
  "critical_fixes_implemented": {
    "dataLayer_manager": {
      "file": "/lib/dataLayer-manager.js",
      "status": "implemented",
      "features": [
        "Enhanced Ecommerce tracking",
        "Subscription purchase events",
        "Quiz completion tracking",
        "Mobile app download conversion",
        "Lead generation events",
        "CDL Help specific events"
      ]
    }
  },
  "compliance": {
    "gdpr": "partial",
    "ccpa": "partial",
    "consent_mode_v2": "needs_completion",
    "pii_protection": "good",
    "status": "needs_improvement"
  },
  "recommendations": {
    "critical": [
      "Integrate dataLayer-manager.js into existing analytics flow",
      "Complete Consent Mode V2 implementation",
      "Implement server-side Enhanced Conversions hashing"
    ],
    "high": [
      "Configure missing environment variables",
      "Add GTM container strategy",
      "Implement cross-domain tracking"
    ],
    "medium": [
      "Add Yandex Metrica consent integration",
      "Optimize script loading strategy",
      "Add comprehensive event validation"
    ]
  },
  "business_impact": {
    "revenue_at_risk": "10-15% conversion underreporting",
    "compliance_risk": "Medium - GDPR gaps",
    "optimization_impact": "High - Missing data affects Google Ads",
    "attribution_accuracy": "Reduced due to incomplete tracking"
  }
}